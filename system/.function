# shorter vs code
c() {
  if [[ $# -eq 0 ]]; then
    command code "$(pwd)"
  else
    command code $@
  fi
}

# Show files on `cd`
cd() {
  builtin cd "$@" && ls
}

# Open query in Dash app
dash() {
  case $# in
    1) QUERY="$1";;
    2) QUERY="$1:$2";;
    *) echo "Usage: dash [docset] query"; return 1;
  esac
  open "dash://$QUERY"
}

# Get gzip size of file
gzip-size() {
  local bytesize=$(gzip -c $1 | wc -c)
  local kbsize=$(bc -l <<< "($bytesize/1024)")
  local formatted=$(printf "%.2f\n" $kbsize)
  echo "$formatted"kb
}

# Automatically install globals and set npm config when switching nvm versions
nvm_with_config() {
  if [[ $1 == "install" ]]; then
    nvm "$@"
    npm-globals
  else
    nvm "$@"
  fi
}
alias nvm="nvm_with_config"

# Create a new directory and enter it
mk() {
  mkdir -p "$@" && cd "$@"
}

# get current weather
# can pass a city name, airport code, etc. to specify location
# (see wttr.in/:help for location possibilities)
# -f flag can be set to get a 3 day forecast
# usage:
# weather
# weather phx
# weather -f London
weather() {
  zparseopts -D -a opts -- f

  local argstr="$@"
  local location=${argstr// /+}
  local request="wttr.in/${location}?Fq"

  if (( ${opts[(Ie)-f]} )); then
    [ "$COLUMNS" -lt 125 ] && request+='n'
  else
    request+='0'
  fi

  curl -H "Accept-Language: ${LANG%_*}" --compressed "$request"
}
